@import "tailwindcss";

/* Safelist for dynamic color-scheme classes (Tailwind v4 does not detect variable class names) */
@source "./safelist.txt";

/* ========== Color schemes: whole-app CSS variables (rgb values for alpha) ========== */
[data-color-scheme="default"] {
  --scheme-bg: 30 41 59;
  --scheme-sidebar: 30 41 59;
  --scheme-border: 51 65 85;
  --scheme-accent: 56 189 248;
  --scheme-accent-bg: 56 189 248 / 0.2;
  /* Blue Archive-ish accent gradient endpoints */
  --ba-cyan: 56 189 248;
  --ba-blue: 14 165 233;
  --scheme-user-bubble: 14 165 233 / 0.3;
  --scheme-user-text: 224 242 254;
  --scheme-assistant-bg: 51 65 85 / 0.8;
  --scheme-assistant-border: 71 85 105;
  --scheme-send-bg: 14 165 233;
  --scheme-send-hover: 56 189 248;
  --scheme-input-focus: 56 189 248 / 0.5;
  --scheme-selection: 14 165 233 / 0.3;
}

[data-color-scheme="warm"] {
  --scheme-bg: 41 37 36;
  --scheme-sidebar: 41 37 36;
  --scheme-border: 69 64 60;
  --scheme-accent: 251 191 36;
  --scheme-accent-bg: 245 158 11 / 0.2;
  --ba-cyan: 251 191 36;
  --ba-blue: 245 158 11;
  --scheme-user-bubble: 245 158 11 / 0.35;
  --scheme-user-text: 254 243 199;
  --scheme-assistant-bg: 51 65 85 / 0.9;
  --scheme-assistant-border: 120 53 15;
  --scheme-send-bg: 245 158 11;
  --scheme-send-hover: 251 191 36;
  --scheme-input-focus: 251 191 36 / 0.5;
  --scheme-selection: 245 158 11 / 0.3;
}

[data-color-scheme="cool"] {
  --scheme-bg: 30 27 75;
  --scheme-sidebar: 30 27 75;
  --scheme-border: 55 48 163;
  --scheme-accent: 129 140 248;
  --scheme-accent-bg: 99 102 241 / 0.2;
  --ba-cyan: 129 140 248;
  --ba-blue: 99 102 241;
  --scheme-user-bubble: 99 102 241 / 0.35;
  --scheme-user-text: 224 231 255;
  --scheme-assistant-bg: 51 65 85 / 0.9;
  --scheme-assistant-border: 49 46 129;
  --scheme-send-bg: 99 102 241;
  --scheme-send-hover: 129 140 248;
  --scheme-input-focus: 129 140 248 / 0.5;
  --scheme-selection: 99 102 241 / 0.3;
}

[data-color-scheme="soft"] {
  --scheme-bg: 42 42 46;
  --scheme-sidebar: 42 42 46;
  --scheme-border: 76 29 55;
  --scheme-accent: 251 113 133;
  --scheme-accent-bg: 244 63 94 / 0.2;
  --ba-cyan: 251 113 133;
  --ba-blue: 244 63 94;
  --scheme-user-bubble: 244 63 94 / 0.3;
  --scheme-user-text: 255 228 230;
  --scheme-assistant-bg: 51 65 85 / 0.85;
  --scheme-assistant-border: 88 28 135;
  --scheme-send-bg: 244 63 94;
  --scheme-send-hover: 251 113 133;
  --scheme-input-focus: 251 113 133 / 0.5;
  --scheme-selection: 244 63 94 / 0.3;
}

/* ========== Blue Archive themed surfaces/patterns ========== */
.ba-mesh {
  position: relative;
}
.ba-mesh::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  /* geometric + soft glow */
  background:
    radial-gradient(1200px 700px at 20% 0%, rgb(var(--ba-cyan) / 0.16), transparent 55%),
    radial-gradient(900px 600px at 100% 20%, rgb(var(--ba-blue) / 0.14), transparent 55%),
    radial-gradient(800px 500px at 40% 110%, rgb(var(--ba-cyan) / 0.10), transparent 60%),
    radial-gradient(circle at 1px 1px, rgb(255 255 255 / 0.08) 1px, transparent 1px);
  background-size: auto, auto, auto, 18px 18px;
  mix-blend-mode: screen;
  opacity: 0.9;
}

.ba-frame {
  border: 1px solid rgb(255 255 255 / 0.10);
  box-shadow:
    0 0 0 1px rgb(0 0 0 / 0.18) inset,
    0 10px 30px rgb(0 0 0 / 0.25);
}

.ba-accent-line {
  position: relative;
}
.ba-accent-line::after {
  content: "";
  position: absolute;
  left: 12px;
  right: 12px;
  bottom: -1px;
  height: 2px;
  background: linear-gradient(90deg, rgb(var(--ba-cyan)), rgb(var(--ba-blue)));
  opacity: 0.9;
  border-radius: 999px;
}

/* BA speech-bubble tails */
.bubble-user,
.bubble-assistant {
  position: relative;
}
.bubble-user::after {
  content: "";
  position: absolute;
  right: -6px;
  top: 14px;
  width: 14px;
  height: 14px;
  background: rgb(var(--scheme-user-bubble));
  transform: rotate(45deg);
  border-radius: 3px;
}
.bubble-assistant::after {
  content: "";
  position: absolute;
  left: -6px;
  top: 14px;
  width: 14px;
  height: 14px;
  background: rgb(var(--scheme-assistant-bg));
  transform: rotate(45deg);
  border-radius: 3px;
  box-shadow: -1px 1px 0 rgb(var(--scheme-assistant-border));
}

.ba-chip {
  background: linear-gradient(135deg, rgb(var(--ba-cyan) / 0.18), rgb(var(--ba-blue) / 0.16));
  border: 1px solid rgb(255 255 255 / 0.10);
  box-shadow: 0 1px 0 rgb(255 255 255 / 0.06) inset;
}

/* Mobile view customization */
@layer base {
  /* Improve touch targets and prevent zoom on inputs on iOS */
  html {
    -webkit-tap-highlight-color: transparent;
  }
  /* Safe area for notched devices */
  .safe-top { padding-top: env(safe-area-inset-top); }
  .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
  .safe-left { padding-left: env(safe-area-inset-left); }
  .safe-right { padding-right: env(safe-area-inset-right); }
}

/* Minimum touch target size (accessibility) */
@layer utilities {
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }
}

/* Chat: wrap long text inside bubbles, thin scrollbar */
.chat-bubble {
  overflow-wrap: break-word;
  word-break: break-word;
}

.chat-messages {
  scrollbar-gutter: stable;
}

.chat-messages::-webkit-scrollbar {
  width: 8px;
}

.chat-messages::-webkit-scrollbar-track {
  background: transparent;
}

.chat-messages::-webkit-scrollbar-thumb {
  background: rgb(71 85 105);
  border-radius: 4px;
}

.chat-messages::-webkit-scrollbar-thumb:hover {
  background: rgb(100 116 139);
}

/* Gradient text (accent) */
.gradient-text {
  background: linear-gradient(135deg, rgb(56 189 248), rgb(14 165 233));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* ========== Keyframe Animations ========== */

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to   { opacity: 1; }
}

@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-30px); }
  to   { opacity: 1; transform: translateX(0); }
}

@keyframes slideInRight {
  from { opacity: 0; transform: translateX(30px); }
  to   { opacity: 1; transform: translateX(0); }
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.92); }
  to   { opacity: 1; transform: scale(1); }
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50%      { transform: translateY(-8px); }
}

@keyframes shimmer {
  0%   { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

@keyframes glowPulse {
  0%, 100% { box-shadow: 0 0 0 0 rgb(var(--scheme-accent) / 0.4); }
  50%      { box-shadow: 0 0 12px 4px rgb(var(--scheme-accent) / 0.25); }
}

@keyframes popIn {
  0%   { opacity: 0; transform: scale(0.85); }
  60%  { opacity: 1; transform: scale(1.05); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes gradientShift {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* ========== Animation Utility Classes ========== */

.animate-fade-in-up {
  animation: fadeInUp 0.5s ease-out both;
}

.animate-fade-in {
  animation: fadeIn 0.4s ease-out both;
}

.animate-slide-in-left {
  animation: slideInLeft 0.4s ease-out both;
}

.animate-slide-in-right {
  animation: slideInRight 0.4s ease-out both;
}

.animate-scale-in {
  animation: scaleIn 0.3s ease-out both;
}

.animate-float {
  animation: float 3s ease-in-out infinite;
}

.animate-glow-pulse {
  animation: glowPulse 2s ease-in-out infinite;
}

.animate-pop-in {
  animation: popIn 0.35s ease-out both;
}

.animate-page {
  animation: fadeIn 0.35s ease-out both;
}

/* Stagger delay utilities */
.delay-100 { animation-delay: 100ms; }
.delay-200 { animation-delay: 200ms; }
.delay-300 { animation-delay: 300ms; }
.delay-400 { animation-delay: 400ms; }
.delay-500 { animation-delay: 500ms; }
.delay-600 { animation-delay: 600ms; }

/* Send button glow */
.send-btn-glow {
  position: relative;
  overflow: hidden;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.send-btn-glow:hover:not(:disabled) {
  transform: scale(1.08);
  box-shadow: 0 0 16px 4px rgb(var(--scheme-accent) / 0.35);
}
.send-btn-glow:active:not(:disabled) {
  transform: scale(0.95);
}

/* Input focus glow */
.input-glow-ring {
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}
.input-glow-ring:focus-within {
  box-shadow: 0 0 0 3px rgb(var(--scheme-accent) / 0.2),
              0 0 20px 2px rgb(var(--scheme-accent) / 0.1);
}

/* Hover lift for cards */
.hover-lift {
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}
.hover-lift:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgb(0 0 0 / 0.15);
}

/* Glass panel */
.glass-panel {
  background: rgb(30 41 59 / 0.75);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid rgb(255 255 255 / 0.08);
}

/* Message bubble shadow */
.bubble-shadow {
  box-shadow: 0 2px 8px rgb(0 0 0 / 0.12), 0 1px 2px rgb(0 0 0 / 0.08);
}

/* Gradient overlay for hero backgrounds */
.hero-overlay {
  background: linear-gradient(180deg, rgb(15 23 42 / 0.5) 0%, rgb(15 23 42 / 0.75) 50%, rgb(15 23 42 / 0.85) 100%);
}

/* Sidebar glass edge */
.sidebar-edge {
  box-shadow: 4px 0 24px rgb(0 0 0 / 0.2);
}

/* Card glow (for selected states) */
.card-glow {
  box-shadow: 0 0 0 1px rgb(255 255 255 / 0.06), 0 4px 16px rgb(0 0 0 / 0.12);
}

/* Respect reduced-motion preference */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
